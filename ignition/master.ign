{"ignition":{"version":"3.2.0"},"passwd":{"users":[{"name":"core","sshAuthorizedKeys":["ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDV174+I6z1uos2Qhq+ex3yhN3Kf7fVRZ6NEYydhKCtpdSq1I5mKAdbaLd8LQCjA7Y0HjXJCkvVLeW2UgfelDbg6c3BNGZ/dCEi6P0VbUHjhzB68CcOoTmcluC/KYaihSg6qiyW/uW1zJ+Rl0bHlMOZZtlE5bqw/KSxGQ6wbVqrE0yL3EwumlSXJq3GyZFkymLyaSZ5+bNsUkQJhGrzYOXYKJpzcsc01DrQ+nCFAQZT68rxpIZVXrEdOQoCmgY3VJqVNtwXC4LVGcA+Pdn3t+OAyT8abQIuOar2PaY26PqjBclnLU35Ki9PJt/dUglfRi5Qzdm68cq5YSHyOGszzHIv faisalsalhi@MacBook-Pro-de-Faisal-2.local"]}]},"storage":{"files":[{"path":"/etc/hostname","contents":{"source":"data:,ip-192-168-1-62.eu-west-3.compute.internal"},"mode":420},{"overwrite":true,"path":"/etc/hosts","contents":{"compression":"gzip","source":"data:;base64,H4sIAAAAAAAC/4zLQQrCQAwF0L2n6AXymR9pbI5TSsDC2Ck2g9d3qy6kB3jUGwoKONS2zPXejrzQFbQJhOmw7kJXoU1CMUV0ecWRcsXSHnvPwLplPLe5frry48o5N/q3G/2fewcAAP//YVGGP7wAAAA="},"mode":420},{"path":"/home/core/.kube/config","contents":{"source":"s3://saasproj/instances/admin.kubeconfig"},"mode":420},{"path":"/etc/etcd/ca.pem","contents":{"source":"s3://saasproj/instances/ca.pem"},"mode":420},{"path":"/etc/etcd/cert.pem","contents":{"source":"s3://saasproj/instances/kube-apiserver.pem"},"mode":420},{"path":"/etc/etcd/cert-key.pem","contents":{"source":"s3://saasproj/instances/kube-apiserver-key.pem"},"mode":420},{"path":"/var/lib/kube-apiserver/ca.pem","contents":{"source":"s3://saasproj/instances/ca.pem"},"mode":420},{"path":"/var/lib/kube-apiserver/cert.pem","contents":{"source":"s3://saasproj/instances/kube-apiserver.pem"},"mode":420},{"path":"/var/lib/kube-apiserver/cert-key.pem","contents":{"source":"s3://saasproj/instances/kube-apiserver-key.pem"},"mode":420},{"path":"/var/lib/kube-controller-manager/ca.pem","contents":{"source":"s3://saasproj/instances/ca.pem"},"mode":420},{"path":"/var/lib/kube-controller-manager/cert.pem","contents":{"source":"s3://saasproj/instances/kube-controller-manager.pem"},"mode":420},{"path":"/var/lib/kube-controller-manager/cert-key.pem","contents":{"source":"s3://saasproj/instances/kube-controller-manager-key.pem"},"mode":420},{"path":"/var/lib/kube-controller-manager/kubeconfig","contents":{"source":"s3://saasproj/instances/kube-controller-manager.kubeconfig"},"mode":420},{"path":"/var/lib/kube-scheduler/ca.pem","contents":{"source":"s3://saasproj/instances/ca.pem"},"mode":420},{"path":"/var/lib/kube-scheduler/cert.pem","contents":{"source":"s3://saasproj/instances/kube-scheduler.pem"},"mode":420},{"path":"/var/lib/kube-scheduler/cert-key.pem","contents":{"source":"s3://saasproj/instances/kube-scheduler-key.pem"},"mode":420},{"path":"/var/lib/kube-scheduler/kubeconfig","contents":{"source":"s3://saasproj/instances/kube-scheduler.kubeconfig"},"mode":420}]},"systemd":{"units":[{"contents":"[Unit]\nDescription=etcd\n\n[Service]\nType=notify\nExecStart=/bin/etcd \\\n  --name ip-192-168-1-62.eu-west-3.compute.internal \\\n  --cert-file=/etc/etcd/cert.pem \\\n  --key-file=/etc/etcd/cert-key.pem \\\n  --peer-cert-file=/etc/etcd/cert.pem \\\n  --peer-key-file=/etc/etcd/cert-key.pem \\\n  --trusted-ca-file=/etc/etcd/ca.pem \\\n  --peer-trusted-ca-file=/etc/etcd/ca.pem \\\n  --peer-client-cert-auth \\\n  --client-cert-auth \\\n  --initial-advertise-peer-urls https://192.168.1.62:2380 \\\n  --listen-peer-urls https://192.168.1.62:2380 \\\n  --listen-client-urls https://192.168.1.62:2379,https://127.0.0.1:2379 \\\n  --advertise-client-urls https://192.168.1.62:2379 \\\n  --data-dir=/var/lib/etcd\nRestart=on-failure\nRestartSec=5\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"etcd.service"},{"contents":"[Unit]\nDescription=Kubernetes Component : API Server\n\n[Service]\nExecStart=/bin/kube-apiserver \\\n  # General Settings\n  --apiserver-count=1 \\\n  --cloud-provider=aws \\\n  # Network Settings\n  --service-cluster-ip-range=10.32.0.0/16 \\\n  # Authorization \n  --authorization-mode=Node,RBAC \\\n  # Authentication\n  --client-ca-file=/var/lib/kube-apiserver/ca.pem \\\n  --tls-cert-file=/var/lib/kube-apiserver/cert.pem \\\n  --tls-private-key-file=/var/lib/kube-apiserver/cert-key.pem \\\n  # Etcd Settings\n  --etcd-servers=https://192.168.1.62:2379 \\\n  --etcd-cafile=/var/lib/kube-apiserver/ca.pem \\\n  --etcd-certfile=/var/lib/kube-apiserver/cert.pem \\\n  --etcd-keyfile=/var/lib/kube-apiserver/cert-key.pem\nRestart=on-failure\n\n[Install]\nWantedBy=kubernetes-ready.target\n","enabled":true,"name":"kube-apiserver.service"},{"contents":"[Unit]\nDescription=Kubernetes Component : Scheduler\n[Service]\nExecStart=/bin/kube-scheduler \\\n  --port 0 \\\n  --kubeconfig=/var/lib/kube-scheduler/kubeconfig \\\n  --client-ca-file=/var/lib/kube-scheduler/ca.pem \\\n  --tls-cert-file=/var/lib/kube-scheduler/cert.pem \\\n  --tls-private-key-file=/var/lib/kube-scheduler/cert-key.pem\nRestart=on-failure\n\n[Install]\nWantedBy=kubernetes-ready.target\n","enabled":true,"name":"kube-scheduler.service"},{"contents":"[Unit]\nDescription=Kubernetes Component : Controller Manager\n\n[Service]\nExecStart=/bin/kube-controller-manager \\\n  # General Settings\n  --cloud-provider=aws \\\n  # Network Settings\n  --allocate-node-cidrs=true \\\n  --configure-cloud-routes=true \\\n  --cluster-cidr=10.200.0.0/16 \\\n  --service-cluster-ip-range=10.32.0.0/16 \\\n  --node-cidr-mask-size=16 \\\n  --flex-volume-plugin-dir=/etc/kubernetes/kubelet-plugins/volume/exec/ \\\n  # Authentication Settings\n  --client-ca-file=/var/lib/kube-controller-manager/ca.pem \\\n  --tls-cert-file=/var/lib/kube-controller-manager/cert.pem \\\n  --tls-private-key-file=/var/lib/kube-controller-manager/cert-key.pem \\\n  # Authorization Settings\n  --kubeconfig=/var/lib/kube-controller-manager/kubeconfig\nRestart=on-failure\n\n[Install]\nWantedBy=kubernetes-ready.target\n","enabled":true,"name":"kube-controller-manager.service"}]}}
